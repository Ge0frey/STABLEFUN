import{g as q,S as Q,a as X,b as Y,P as Z,T as $,V as I}from"./index-DSRhGWqf.js";var G={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function r(_,c,s){this.fn=_,this.context=c,this.once=s||!1}function o(_,c,s,d,v){if(typeof s!="function")throw new TypeError("The listener must be a function");var u=new r(s,d||_,v),h=e?e+c:c;return _._events[h]?_._events[h].fn?_._events[h]=[_._events[h],u]:_._events[h].push(u):(_._events[h]=u,_._eventsCount++),_}function l(_,c){--_._eventsCount===0?_._events=new n:delete _._events[c]}function p(){this._events=new n,this._eventsCount=0}p.prototype.eventNames=function(){var c=[],s,d;if(this._eventsCount===0)return c;for(d in s=this._events)t.call(s,d)&&c.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(s)):c},p.prototype.listeners=function(c){var s=e?e+c:c,d=this._events[s];if(!d)return[];if(d.fn)return[d.fn];for(var v=0,u=d.length,h=new Array(u);v<u;v++)h[v]=d[v].fn;return h},p.prototype.listenerCount=function(c){var s=e?e+c:c,d=this._events[s];return d?d.fn?1:d.length:0},p.prototype.emit=function(c,s,d,v,u,h){var w=e?e+c:c;if(!this._events[w])return!1;var a=this._events[w],m=arguments.length,g,f;if(a.fn){switch(a.once&&this.removeListener(c,a.fn,void 0,!0),m){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,s),!0;case 3:return a.fn.call(a.context,s,d),!0;case 4:return a.fn.call(a.context,s,d,v),!0;case 5:return a.fn.call(a.context,s,d,v,u),!0;case 6:return a.fn.call(a.context,s,d,v,u,h),!0}for(f=1,g=new Array(m-1);f<m;f++)g[f-1]=arguments[f];a.fn.apply(a.context,g)}else{var A=a.length,b;for(f=0;f<A;f++)switch(a[f].once&&this.removeListener(c,a[f].fn,void 0,!0),m){case 1:a[f].fn.call(a[f].context);break;case 2:a[f].fn.call(a[f].context,s);break;case 3:a[f].fn.call(a[f].context,s,d);break;case 4:a[f].fn.call(a[f].context,s,d,v);break;default:if(!g)for(b=1,g=new Array(m-1);b<m;b++)g[b-1]=arguments[b];a[f].fn.apply(a[f].context,g)}}return!0},p.prototype.on=function(c,s,d){return o(this,c,s,d,!1)},p.prototype.once=function(c,s,d){return o(this,c,s,d,!0)},p.prototype.removeListener=function(c,s,d,v){var u=e?e+c:c;if(!this._events[u])return this;if(!s)return l(this,u),this;var h=this._events[u];if(h.fn)h.fn===s&&(!v||h.once)&&(!d||h.context===d)&&l(this,u);else{for(var w=0,a=[],m=h.length;w<m;w++)(h[w].fn!==s||v&&!h[w].once||d&&h[w].context!==d)&&a.push(h[w]);a.length?this._events[u]=a.length===1?a[0]:a:l(this,u)}return this},p.prototype.removeAllListeners=function(c){var s;return c?(s=e?e+c:c,this._events[s]&&l(this,s)):(this._events=new n,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=e,p.EventEmitter=p,i.exports=p})(G);var ee=G.exports;const ne=q(ee);function te(i){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),e=0;e<t.length;e++)t[e]=255;for(var n=0;n<i.length;n++){var r=i.charAt(n),o=r.charCodeAt(0);if(t[o]!==255)throw new TypeError(r+" is ambiguous");t[o]=n}var l=i.length,p=i.charAt(0),_=Math.log(l)/Math.log(256),c=Math.log(256)/Math.log(l);function s(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";for(var h=0,w=0,a=0,m=u.length;a!==m&&u[a]===0;)a++,h++;for(var g=(m-a)*c+1>>>0,f=new Uint8Array(g);a!==m;){for(var A=u[a],b=0,E=g-1;(A!==0||b<w)&&E!==-1;E--,b++)A+=256*f[E]>>>0,f[E]=A%l>>>0,A=A/l>>>0;if(A!==0)throw new Error("Non-zero carry");w=b,a++}for(var x=g-w;x!==g&&f[x]===0;)x++;for(var z=p.repeat(h);x<g;++x)z+=i.charAt(f[x]);return z}function d(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;for(var h=0,w=0,a=0;u[h]===p;)w++,h++;for(var m=(u.length-h)*_+1>>>0,g=new Uint8Array(m);u[h];){var f=t[u.charCodeAt(h)];if(f===255)return;for(var A=0,b=m-1;(f!==0||A<a)&&b!==-1;b--,A++)f+=l*g[b]>>>0,g[b]=f%256>>>0,f=f/256>>>0;if(f!==0)throw new Error("Non-zero carry");a=A,h++}for(var E=m-a;E!==m&&g[E]===0;)E++;for(var x=new Uint8Array(w+(m-E)),z=w;E!==m;)x[z++]=g[E++];return x}function v(u){var h=d(u);if(h)return h;throw new Error("Non-base"+l+" character")}return{encode:s,decodeUnsafe:d,decode:v}}var ie=te;const re=ie,se="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var ae=re(se);const M=q(ae);let U;const oe=new Uint8Array(16);function ce(){if(!U&&(U=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!U))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(oe)}const y=[];for(let i=0;i<256;++i)y.push((i+256).toString(16).slice(1));function de(i,t=0){return y[i[t+0]]+y[i[t+1]]+y[i[t+2]]+y[i[t+3]]+"-"+y[i[t+4]]+y[i[t+5]]+"-"+y[i[t+6]]+y[i[t+7]]+"-"+y[i[t+8]]+y[i[t+9]]+"-"+y[i[t+10]]+y[i[t+11]]+y[i[t+12]]+y[i[t+13]]+y[i[t+14]]+y[i[t+15]]}const le=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),V={randomUUID:le};function ue(i,t,e){if(V.randomUUID&&!i)return V.randomUUID();i=i||{};const n=i.random||(i.rng||ce)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,de(n)}function P(i){return i.version===void 0}function j(i){return P(i)?i.serialize({verifySignatures:!1,requireAllSignatures:!1}):i.serialize()}var B=function(i,t,e,n){function r(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function p(s){try{c(n.next(s))}catch(d){l(d)}}function _(s){try{c(n.throw(s))}catch(d){l(d)}}function c(s){s.done?o(s.value):r(s.value).then(p,_)}c((n=n.apply(i,t||[])).next())})};function F(i){return B(this,void 0,void 0,function*(){try{return yield i.request({method:"wallet_getSnaps"}),!0}catch{return!1}})}function he(){return B(this,void 0,void 0,function*(){try{const i=window.ethereum;if(!i)return null;if(i.providers&&Array.isArray(i.providers)){const t=i.providers;for(const e of t)if(yield F(e))return e}if(i.detected&&Array.isArray(i.detected)){const t=i.detected;for(const e of t)if(yield F(e))return e}return(yield F(i))?i:null}catch(i){return console.error(i),null}})}const fe="solana:mainnet",_e="solana:devnet",pe="solana:testnet",me="solana:localnet",J=[fe,_e,pe,me];function H(i){return J.includes(i)}var T=function(i,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(i):n?n.value:t.get(i)},C=function(i,t,e,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!r:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(i,e):r?r.value=e:t.set(i,e),e},K,O,k,N,L,W;const ge=J,we=[Q,X,Y];class R{get address(){return T(this,K,"f")}get publicKey(){return T(this,O,"f").slice()}get chains(){return T(this,k,"f").slice()}get features(){return T(this,N,"f").slice()}get label(){return T(this,L,"f")}get icon(){return T(this,W,"f")}constructor({address:t,publicKey:e,label:n,icon:r}){K.set(this,void 0),O.set(this,void 0),k.set(this,void 0),N.set(this,void 0),L.set(this,void 0),W.set(this,void 0),new.target===R&&Object.freeze(this),C(this,K,t,"f"),C(this,O,e,"f"),C(this,k,ge,"f"),C(this,N,we,"f"),C(this,L,n,"f"),C(this,W,r,"f")}}K=new WeakMap,O=new WeakMap,k=new WeakMap,N=new WeakMap,L=new WeakMap,W=new WeakMap;var S=function(i,t,e,n){function r(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function p(s){try{c(n.next(s))}catch(d){l(d)}}function _(s){try{c(n.throw(s))}catch(d){l(d)}}function c(s){s.done?o(s.value):r(s.value).then(p,_)}c((n=n.apply(i,t||[])).next())})};class D extends ne{constructor(t){super(),this._network="mainnet-beta",this._iframeParams={},this._element=null,this._iframe=null,this._publicKey=null,this._account=null,this._isConnected=!1,this._connectHandler=null,this._messageHandlers={},this._handleEvent=e=>{var n,r;switch(e.type){case"connect":{this._collapseIframe(),!((n=e.data)===null||n===void 0)&&n.publicKey?(this._publicKey=e.data.publicKey,this._isConnected=!0,this._connectHandler&&(this._connectHandler.resolve(),this._connectHandler=null),this._connected()):(this._connectHandler&&(this._connectHandler.reject(),this._connectHandler=null),this._disconnected());return}case"disconnect":{this._connectHandler&&(this._connectHandler.reject(),this._connectHandler=null),this._disconnected();return}case"accountChanged":{!((r=e.data)===null||r===void 0)&&r.publicKey?(this._publicKey=e.data.publicKey,this.emit("accountChanged",this.publicKey),this._standardConnected()):(this.emit("accountChanged",void 0),this._standardDisconnected());return}default:return}},this._handleResize=e=>{e.resizeMode==="full"?e.params.mode==="fullscreen"?this._expandIframe():e.params.mode==="hide"&&this._collapseIframe():e.resizeMode==="coordinates"&&this._resizeIframe(e.params)},this._handleMessage=e=>{var n;if(((n=e.data)===null||n===void 0?void 0:n.channel)!=="solflareIframeToWalletAdapter")return;const r=e.data.data||{};if(r.type==="event")this._handleEvent(r.event);else if(r.type==="resize")this._handleResize(r);else if(r.type==="response"&&this._messageHandlers[r.id]){const{resolve:o,reject:l}=this._messageHandlers[r.id];delete this._messageHandlers[r.id],r.error?l(r.error):o(r.result)}},this._removeElement=()=>{this._element&&(this._element.remove(),this._element=null)},this._removeDanglingElements=()=>{const e=document.getElementsByClassName("solflare-metamask-wallet-adapter-iframe");for(const n of e)n.parentElement&&n.remove()},this._injectElement=()=>{this._removeElement(),this._removeDanglingElements();const e=Object.assign(Object.assign({},this._iframeParams),{mm:!0,v:1,cluster:this._network||"mainnet-beta",origin:window.location.origin||"",title:document.title||""}),n=Object.keys(e).map(o=>`${o}=${encodeURIComponent(e[o])}`).join("&"),r=`${D.IFRAME_URL}?${n}`;this._element=document.createElement("div"),this._element.className="solflare-metamask-wallet-adapter-iframe",this._element.innerHTML=`
      <iframe src='${r}' style='position: fixed; top: 0; bottom: 0; left: 0; right: 0; width: 100%; height: 100%; border: none; border-radius: 0; z-index: 99999; color-scheme: auto;' allowtransparency='true'></iframe>
    `,document.body.appendChild(this._element),this._iframe=this._element.querySelector("iframe"),window.addEventListener("message",this._handleMessage,!1)},this._collapseIframe=()=>{this._iframe&&(this._iframe.style.top="",this._iframe.style.right="",this._iframe.style.height="2px",this._iframe.style.width="2px")},this._expandIframe=()=>{this._iframe&&(this._iframe.style.top="0px",this._iframe.style.bottom="0px",this._iframe.style.left="0px",this._iframe.style.right="0px",this._iframe.style.width="100%",this._iframe.style.height="100%")},this._resizeIframe=e=>{this._iframe&&(this._iframe.style.top=isFinite(e.top)?`${e.top}px`:"",this._iframe.style.bottom=isFinite(e.bottom)?`${e.bottom}px`:"",this._iframe.style.left=isFinite(e.left)?`${e.left}px`:"",this._iframe.style.right=isFinite(e.right)?`${e.right}px`:"",this._iframe.style.width=isFinite(e.width)?`${e.width}px`:e.width,this._iframe.style.height=isFinite(e.height)?`${e.height}px`:e.height)},this._sendIframeMessage=e=>{if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");return new Promise((n,r)=>{var o,l;const p=ue();this._messageHandlers[p]={resolve:n,reject:r},(l=(o=this._iframe)===null||o===void 0?void 0:o.contentWindow)===null||l===void 0||l.postMessage({channel:"solflareWalletAdapterToIframe",data:Object.assign({id:p},e)},"*")})},this._connected=()=>{this._isConnected=!0,this.emit("connect",this.publicKey),this._standardConnected()},this._disconnected=()=>{this._publicKey=null,this._isConnected=!1,window.removeEventListener("message",this._handleMessage,!1),this._removeElement(),this.emit("disconnect"),this._standardDisconnected()},this._standardConnected=()=>{if(!this.publicKey)return;const e=this.publicKey.toString();(!this._account||this._account.address!==e)&&(this._account=new R({address:e,publicKey:this.publicKey.toBytes()}),this.emit("standard_change",{accounts:this.standardAccounts}))},this._standardDisconnected=()=>{this._account&&(this._account=null,this.emit("standard_change",{accounts:this.standardAccounts}))},t!=null&&t.network&&(this._network=t==null?void 0:t.network),window.SolflareMetaMaskParams&&(this._iframeParams=Object.assign(Object.assign({},this._iframeParams),window.SolflareMetaMaskParams)),t!=null&&t.params&&(this._iframeParams=Object.assign(Object.assign({},this._iframeParams),t==null?void 0:t.params))}get publicKey(){return this._publicKey?new Z(this._publicKey):null}get standardAccount(){return this._account}get standardAccounts(){return this._account?[this._account]:[]}get isConnected(){return this._isConnected}get connected(){return this.isConnected}get autoApprove(){return!1}connect(){return S(this,void 0,void 0,function*(){this.connected||(this._injectElement(),yield new Promise((t,e)=>{this._connectHandler={resolve:t,reject:e}}))})}disconnect(){return S(this,void 0,void 0,function*(){yield this._sendIframeMessage({method:"disconnect"}),this._disconnected()})}signTransaction(t){var e;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const n=j(t),r=yield this._sendIframeMessage({method:"signTransactionV2",params:{transaction:M.encode(n)}}),{transaction:o}=r;return P(t)?$.from(M.decode(o)):I.deserialize(M.decode(o))}catch(n){throw new Error(((e=n==null?void 0:n.toString)===null||e===void 0?void 0:e.call(n))||"Failed to sign transaction")}})}signAllTransactions(t){var e;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const n=t.map(o=>j(o)),{transactions:r}=yield this._sendIframeMessage({method:"signAllTransactionsV2",params:{transactions:n.map(o=>M.encode(o))}});return r.map((o,l)=>P(t[l])?$.from(M.decode(o)):I.deserialize(M.decode(o)))}catch(n){throw new Error(((e=n==null?void 0:n.toString)===null||e===void 0?void 0:e.call(n))||"Failed to sign transactions")}})}signAndSendTransaction(t,e){var n;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const r=j(t),{signature:o}=yield this._sendIframeMessage({method:"signAndSendTransaction",params:{transaction:M.encode(r),options:e}});return o}catch(r){throw new Error(((n=r==null?void 0:r.toString)===null||n===void 0?void 0:n.call(r))||"Failed to sign and send transaction")}})}signMessage(t,e="utf8"){var n;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const{signature:r}=yield this._sendIframeMessage({method:"signMessage",params:{data:M.encode(t),display:e}});return Uint8Array.from(M.decode(r))}catch(r){throw new Error(((n=r==null?void 0:r.toString)===null||n===void 0?void 0:n.call(r))||"Failed to sign message")}})}sign(t,e="utf8"){return S(this,void 0,void 0,function*(){return yield this.signMessage(t,e)})}static isSupported(){return S(this,void 0,void 0,function*(){return!!(yield he())})}standardSignAndSendTransaction(...t){return S(this,void 0,void 0,function*(){if(!this.connected)throw new Error("not connected");const e=[];if(t.length===1){const{transaction:n,account:r,chain:o,options:l}=t[0],{minContextSlot:p,preflightCommitment:_,skipPreflight:c,maxRetries:s}=l||{};if(r!==this._account)throw new Error("invalid account");if(!H(o))throw new Error("invalid chain");const d=yield this.signAndSendTransaction(I.deserialize(n),{preflightCommitment:_,minContextSlot:p,maxRetries:s,skipPreflight:c});e.push({signature:M.decode(d)})}else if(t.length>1)for(const n of t)e.push(...yield this.standardSignAndSendTransaction(n));return e})}standardSignTransaction(...t){return S(this,void 0,void 0,function*(){if(!this.connected)throw new Error("not connected");const e=[];if(t.length===1){const{transaction:n,account:r,chain:o}=t[0];if(r!==this._account)throw new Error("invalid account");if(o&&!H(o))throw new Error("invalid chain");const l=yield this.signTransaction(I.deserialize(n));e.push({signedTransaction:l.serialize()})}else if(t.length>1){let n;for(const l of t){if(l.account!==this._account)throw new Error("invalid account");if(l.chain){if(!H(l.chain))throw new Error("invalid chain");if(n){if(l.chain!==n)throw new Error("conflicting chain")}else n=l.chain}}const r=t.map(({transaction:l})=>I.deserialize(l)),o=yield this.signAllTransactions(r);e.push(...o.map(l=>({signedTransaction:l.serialize()})))}return e})}standardSignMessage(...t){return S(this,void 0,void 0,function*(){if(!this.connected)throw new Error("not connected");const e=[];if(t.length===1){const{message:n,account:r}=t[0];if(r!==this._account)throw new Error("invalid account");const o=yield this.signMessage(n);e.push({signedMessage:n,signature:o})}else if(t.length>1)for(const n of t)e.push(...yield this.standardSignMessage(n));return e})}}D.IFRAME_URL="https://widget.solflare.com/";export{R as StandardSolflareMetaMaskWalletAccount,D as default};
